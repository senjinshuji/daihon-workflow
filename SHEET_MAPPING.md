# Google Sheets シート名マッピング

## 📊 スプレッドシート情報

**Spreadsheet ID**: `1Bm8xgoAeocPhiPoisVt1uMc0MTEuH70SDME4N1bg6mo`

## 📋 シート名対応表

| スプレッドシートのシート名 | 説明 | 出力CSVファイル名 |
|---------------------------|------|------------------|
| `レジェンド台本` | 市場ベストセラー台本 | `market_bestsellers.csv` |
| `【配信結果】上位` | 高パフォーマンス台本（社内上位グループ） | `internal_top_group.csv` |
| `【配信結果】中位` | 中パフォーマンス台本（社内中位グループ） | `internal_middle_group.csv` |
| `【配信結果】下位` | 低パフォーマンス台本（社内下位グループ） | `internal_bottom_group.csv` |
| `ローデータ` | 基本的な台本データ（参照用） | - |

## 🔍 データ内容

### レジェンド台本（market_bestsellers.csv）
- **内容**: 市場で実績のあるベストセラー台本
- **用途**: 業界ベンチマーク、成功パターンの分析
- **重要性**: 最も参考になる外部データ

### 【配信結果】上位（internal_top_group.csv）
- **内容**: 社内で高いパフォーマンスを示した台本
- **用途**: 自社の成功パターン分析
- **重要性**: 実践的な成功事例

### 【配信結果】中位（internal_middle_group.csv）
- **内容**: 社内で中程度のパフォーマンスを示した台本
- **用途**: 改善機会の特定
- **重要性**: 最適化の余地がある事例

### 【配信結果】下位（internal_bottom_group.csv）
- **内容**: 社内で低いパフォーマンスを示した台本
- **用途**: 失敗要因の分析
- **重要性**: 避けるべきパターンの特定

## 📝 期待されるデータ形式

各シートは以下の列を含むことが期待されます（例）：

```
| 台本ID | タイトル | 内容 | フォーマット | パフォーマンス指標 | ... |
|--------|---------|------|-------------|------------------|-----|
| 001    | ...     | ...  | ...         | ...              | ... |
```

## ⚙️ 技術的な実装

`fetch_sheets_data.py`スクリプトは以下のマッピングを使用：

```python
sheets_to_fetch = {
    'market_bestsellers': 'レジェンド台本!A:Z',
    'internal_top_group': '【配信結果】上位!A:Z',
    'internal_middle_group': '【配信結果】中位!A:Z',
    'internal_bottom_group': '【配信結果】下位!A:Z'
}
```

## 🚨 注意事項

1. **シート名の完全一致**: シート名は大文字小文字、特殊文字を含めて完全に一致する必要があります
2. **アクセス権限**: サービスアカウント（`daihon@daihon-api.iam.gserviceaccount.com`）に閲覧権限が必要
3. **データ範囲**: A列からZ列までのデータを取得（必要に応じて範囲を調整可能）
4. **文字エンコーディング**: UTF-8で保存され、日本語文字も正しく処理されます

## 🔄 更新履歴

- 2025-01-14: 初版作成、実際のシート名に基づくマッピング設定